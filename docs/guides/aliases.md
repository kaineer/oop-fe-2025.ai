# Алиасы для управления проектом

## Алиасы для управления шагами уроков

### Алиасы для управления шагами уроков

#### `step-copy`
Копирует шаги между уроками согласно правилам:

- Если в текущем уроке еще нет шагов, копирует файлы из последнего шага предыдущего урока
- Если шаги уже есть, создает новый каталог шага и копирует текущее состояние из предыдущего шага
- В процессе копирования из js-кода должны быть удалены комментарии вида `// REF: block-name` и `// ENDREF`. Для html-файлов удаляться должны строки, в которых те же комментарии имеют вид `<!-- REF: block-name -->` и `<!-- ENDREF -->`

#### `step-remove`
Удаляет содержимое текущего шага из каталога с последним шагом и удаляет сам каталог

#### `step-rewrite`
Переписывает состояние шага, чтобы, например, исправить ошибки, допущенные в формулировке `step-copy`

- Выполняет `step-remove`, чтобы почистить текущее состояние последнего шага
- Выполняет `step-copy`, чтобы переписать новый шаг

#### `step-update-meta`
Обновляет метаданные урока:

- Добавляет в последний шаг, у которого не заполнено поле `path`, ссылку на подкаталог
- Добавляет пустые ключи `actions`, `actions[0].{name, ref}` и `expected`

### Алиасы для работы с Git

#### `git-commit`
Автоматизирует процесс коммита изменений:

- Делает обзор измененных файлов
- Формирует короткое и расширенное описание для commit message
- Добавляет все измененные файлы в индекс (`git add .`)
- Выполняет коммит с информативным сообщением

#### `git-push`
Автоматизирует процесс отправки изменений:

- Выполняет `git-commit`, если есть несохраненные изменения
- Отправляет изменения в удаленный репозиторий (`git push origin master`)
- Обеспечивает синхронизацию локальных и удаленных изменений
- Очищает каталоги `node_modules` после успешного пуша
- Выполняет скрипт `clean-node-modules.sh` для удаления зависимостей

## Использование

```bash
# Копирование шага в текущий урок
step-copy

# Обновление метаданных урока
step-update-meta

# Коммит изменений с автоматическим описанием
git-commit

# Коммит и пуш изменений с очисткой node_modules
git-push
```

## Правила для алиасов

### Для уроков типа "practice"

Для уроков с типом "practice" автоматически применяются следующие правила:

1. **Инициализация урока**: При создании нового урока типа "practice", если в нем еще нет шагов, автоматически копируется последний шаг из предыдущего урока.

2. **Создание нового шага**: При добавлении нового шага в существующий урок, создается копия предыдущего шага с сохранением текущего состояния проекта.

3. **Обновление метаданных**: После создания шага автоматически обновляются метаданные урока, добавляя информацию о новом шаге и его ожидаемых результатах.

### Для Git-операций

- **`git-commit`**: Анализирует изменения в текущем уроке и формирует информативное сообщение коммита
- **`git-push`**: Обеспечивает полный цикл сохранения, синхронизации и очистки изменений

## Структура метаданных

После применения алиасов структура `meta.yaml` должна содержать:

```yaml
project:
  name: "project-name"
  steps:
    - name: "Описание шага"
      path: "src/step01"
      actions:
        - name: "Действие 1"
          ref: "REF_ID"
      expected: "Ожидаемый результат"
```

## Пример workflow с Git-алиасами

### Базовый workflow

1. Создать новый урок типа "practice"
2. Выполнить `step-copy` для инициализации первого шага
3. Выполнить `step-update-meta` для настройки метаданных
4. Разрабатывать функционал в текущем шаге
5. При необходимости создать новый шаг: `step-copy` + `step-update-meta`
6. Сохранять прогресс: `git-commit` или `git-push`
7. Повторять шаги 4-6 до завершения урока

### Полный workflow с автоматизацией Git
```bash
# Начало работы над уроком
step-copy
step-update-meta

# Разработка функционала
# ... работа над кодом ...

# Сохранение промежуточного результата
git-commit

# Продолжение разработки
# ... работа над кодом ...

# Создание нового шага и сохранение
step-copy
step-update-meta
git-push

# Завершение урока
git-push
```

### Папка scripts

Для организации служебных скриптов проекта используется папка `scripts/`. Все вспомогательные скрипты размещаются в этой папке для удобства управления и поддержания порядка в проекте.

### Скрипт очистки node_modules

Для ручной очистки каталогов `node_modules` используйте скрипт:

```bash
./scripts/clean-node-modules.sh
```

Этот скрипт:
- Удаляет все каталоги `node_modules` в проекте
- Удаляет файлы `package-lock.json`
- Сохраняет репозиторий чистым от зависимостей
